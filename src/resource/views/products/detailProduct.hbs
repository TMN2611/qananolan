<div class="detailProduct mt 5 pt-5">
    <div class="row">
        <div class="col-md-7 col-sm-12 detailProduct__img">
        
            <div class="detailProduct__img--main">
                       <div class="btn-open-modal" style="cursor: pointer;" data-toggle="modal" data-target="#ProductImgZoomModal">
                            <img src="{{productInfor.productImg.[0]}}" alt="">

                        </div>
                        <div class="detailProduct__zoomIn--Btn">
                            <button class="btn-open-modal" data-toggle="modal" data-target="#ProductImgZoomModal">
                                    <img src="/img/Icons/zoom.png" alt="">
                            </button>
                        </div>
                    
            </div>

            <div class="detailProduct__img--list">
                
                  <button class="btn-open-modal" data-toggle="modal" data-target="#ProductImgZoomModal">
                                    {{#activeFirstProuctImg}}
                                         {{productInfor}}
                                     {{/activeFirstProuctImg}}           
                 </button>
             

                   
            </div>
        </div>
        <div class="col-md-5 col-sm-12 detailProduct__content">
            <input type="hidden" id='productId' value='{{productInfor._id}}'>
            <h1 class="detailProduct__content--name border-bottom">
                {{productInfor.productName}}
            </h1>
            <h1 class="detailProduct__content--price border-bottom">
                   {{#if productInfor.sale includeZero=false}}
                        <span class='product__newPrice detailProduct__price' data-price='{{productInfor.productSalePrice}}'>{{number
                            productInfor.productSalePrice
                          }}‚Ç´</span>
                        <span class='product__oldPrice detailProduct__price'>{{number productInfor.productPrice}}‚Ç´</span>
                        <div class="productDetail__sale--percent p-2 bg-orange">
                            <span class=''>{{productInfor.sale}} % Gi·∫£m</span>
                        </div>
                        {{else}}
                        <span class='product__oldPrice--notsale detailProduct__price' data-price='{{productInfor.productPrice}}'>{{number productInfor.productPrice}}‚Ç´</span>

                      {{/if}}
            </h1>

            <div class="promotion py-3 border-bottom ">
                <h6 class="promotion__title detailProduct__content--title"> <img class='hiddenonMobile' src="/img/Icons/sale-tag.png" alt="">Khuy·∫øn m√£i :</h6>
                <div class='productColor__content-promotion'>
                    <p><img class='icon-small' src="/img/Icons/hot-sale.png" alt=""> MI·ªÑN PH√ç SHIP</p>
                    <ul>
                        <li>
                           <img class='icon-small' src="/img/Icons/hot-sale.png" alt="">Khuy·∫øn m√£i :</h6> Gi·∫£m 100k ƒë∆°n h√†ng t·ª´ 1.000.000 VND
                        </li>
                        <li>
                            <img class='icon-small' src="/img/Icons/hot-sale.png" alt="">Khuy·∫øn m√£i :</h6> Gi·∫£m 150k ƒë∆°n h√†ng t·ª´ 1.500.000 VND
                        </li>
                        <li>
                            <img class='icon-small' src="/img/Icons/hot-sale.png" alt="">Khuy·∫øn m√£i :</h6> Gi·∫£m 200k ƒë∆°n h√†ng t·ª´ 2.000.000 VND
                        </li>
                    </ul>
                </div>

                {{!-- <div class="promotion__content ">
                     <p>
                        <a class="btn btn-primary promotion__btn bg-orange" data-toggle="collapse" href="#salecode" role="button" aria-expanded="false" aria-controls="salecode">
                            Nh·∫≠p m√£ FREESHIP mi·ªÖn ph√≠ giao h√†ng >
                        </a>
             
                    </p>
                    <div class="collapse" id="salecode">
                    <div class="card card-body">
                        Nh·∫≠p m√£ <span class='text-orange'>FREESHIP</span> mi·ªÖn ph√≠ giao h√†ng khi mua ƒë∆°n h√†ng t·ª´ 400,000 ƒë √°p d·ª•ng t·ª´ ng√†y 22/08 - 31/08. Ch∆∞∆°ng tr√¨nh kh√¥ng √°p d·ª•ng v·ªõi c√°c ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i kh√°c.
                    </div>
                    </div>

                </div> --}}
            </div>

            <div class="selectSize py-3 border-bottom">
                <h6 class="selectSize__title detailProduct__content--title">Ch·ªçn size</h6>
                <ul class="selectSize__btn--list">
                    {{#activeFirstSize}}{{productInfor}}{{/activeFirstSize}}
                </ul>
            </div>
            <div class="productColor py-3 border-bottom d-flex">
                <h6 class="productColor__title detailProduct__content--title">M√†u s·∫Øc</h6>
                <div class="productColor__content">
                    <div class='w-100'>

                      <p  style= "color:{{productInfor.productColor}}" class=" productColor__text text-center m-0 p-2 text-uppercase font-weight-bold" >{{productInfor.productColor}}</p>
                    </div>
                </div>
              
            </div>

            

            <div class="selector-actions py-3">
                <div class="quantity-area clearfix">
                    <input type="button" value="-" onclick="minusQuantity()" class="qty-btn">
                    <input type="text" id="quantity" name="quantity" value="1" min="1" class="quantity-selector"  disabled="disabled">
                    <input type="button" value="+" onclick="plusQuantity()" class="qty-btn">
                </div>
                
                {{!-- <div class='mt-4'>
                    {{> slideBtn title="Th√™m v√†o gi·ªè h√†ng"}}
                </div> --}}
                <button type="button" class="addToCart-btn btn btn-demo btn-lg btn-warning" data-toggle="modal" data-target="#cartModal" data-whatever="{{productInfor}}">
			            Th√™m v√†o gi·ªè h√†ng
		        </button>

                <!-- Modal -->
                    <div class="modal right fade" id="cartModal" tabindex="-1" role="dialog" aria-labelledby="cartModalLabel2">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">

                                <div class="modal-header">
                                    <h4 class="modal-title" id="cartModalLabel2">Gi·ªè h√†ng</h4>
                                    <button type="button" class="close close-cartModal-btn" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true"><i class="fa-solid fa-xmark"></i></span>
                                    <button>
                                </div>

                                <div class="modal-body">
                                     <p class='cart__quality text-center  mt-4 mb-5'>B·∫°n c√≥ 
                                         <span class='cart__quality--number'></span> s·∫£n ph·∫©m trong gi·ªè h√†ng</p>
                                    <ul class="cart__list">
                                    </ul>
                                    <div class="d-flex justify-content-between my-5">
                                        <span class='font-weight-bold'>T·ªîNG TI·ªÄN</span> <span class='cart__total--money'>adad</span>
                                    </div>
                                    <div class="cartBtn__container justify-content-between">
                                        <a href="/cart">{{> slideBtn title="Xem gi·ªè h√†ng"}}</a>

                                        <span href="">
                                             {{> slideBtn title="Thanh to√°n" class="pay__btn"}}
                                        </span>
                                        
                                           
                                    </div>

                                </div>

                            </div><!-- modal-content -->
                        </div><!-- modal-dialog -->
                    </div>
                <!-- modal -->
                
                <p class='mt-4'>ƒê·ªëi v·ªõi c√°c s·∫£n ph·∫©m ƒë√£ h·∫øt h√†ng, b·∫°n c√≥ th·ªÉ li√™n h·ªá qua <strong><a href="https://www.facebook.com/profile.php?id=100085568778678" target="_blank" >Fanpage QanaNolan</a></strong>  ƒë·ªÉ ƒë∆∞·ª£c nh√¢n vi√™n h·ªó tr·ª£ ƒë·∫∑t tr∆∞·ªõc s·∫£n ph·∫©m v√† s·∫Ω li√™n h·ªá v·ªõi b·∫°n ngay khi c√≥ h√†ng</p>

                <a href='#' class='mt-3 text-danger'>H∆∞·ªõng d·∫´n ch·ªçn size</a>
                <p >
                    
                    G·ªçi <a href="tel:{{hotline}}">{{hotline}}</a> ƒë·ªÉ mua h√†ng nhanh h∆°n
                    Mi·ªÖn ph√≠ giao h√†ng t·ª´ 800.000VNƒê
                </p>
			</div>

            

        
        </div>
        {{!-- <div class="col-12">
            <div class="row pt-5">
                {{#each productInfor.productImg}}
                <div class="col-12 col-md-6 mb-5">
                    <img src="{{this}}" style='width:100%' alt="">

                </div>
                {{/each}}

            </div>

        </div> --}}

        <div class="col-12 mt-5">
            <div class="product__desc--tabs">

                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="productDesc-tab" data-toggle="pill" data-target="#productDesc" type="button" role="tab" aria-controls="productDesc" aria-selected="true">M√¥ t·∫£ s·∫£n ph·∫©m</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="returnPolicy-tab" data-toggle="pill" data-target="#returnPolicy" type="button" role="tab" aria-controls="returnPolicy" aria-selected="false">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="pstorageInstructions-tab" data-toggle="pill" data-target="#pstorageInstructions" type="button" role="tab" aria-controls="pstorageInstructions" aria-selected="false">H∆∞·ªõng d·∫´n b·∫£o qu·∫£n</button>
                    </li>
                </ul>
                <div class="tab-content" id="pills-tabCotent">
                <div class="tab-pane fade show active" id="productDesc" role="tabpanel" aria-labelledby="productDesc-tab">
                    <div class="description-productdetail">
                        {{#each productInfor.productDescription}}
                            <p> 
                            {{#if this.emoji}}
                              <span> 
                                {{!-- {{this.emoji}} --}}
                              </span>
                            {{/if}}
                              {{this.descText}}
                            </p>
                            
                            
                        {{/each}}
                    </div>
                </div>
                <div class="tab-pane fade" id="returnPolicy" role="tabpanel" aria-labelledby="returnPolicy-tab">
                    <div class="description-productdetail">
                         <h5 class="policy-title">
                                    ƒêi·ªÅu ki·ªán ƒë·ªïi , tr·∫£
                                </h5>
                                <p>
                                    <ol class="s">
                                        <li>
                                                Qu√Ω kh√°ch c√≥ th·ªÉ ƒë·ªïi tr·∫£ h√†ng tho·∫£i m√°i trong v√≤ng <span class="font-weight-bold">7 ng√†y</span> k·ªÉ t·ª´ ng√†y nh·∫≠n h√†ng .
                                        </li>

                                        <li>
                                            Gi·ªØ s·∫£n ph·∫©m kh√¥ng b·ªã b·∫©n , h·ªèng ƒë·ªÉ thu·∫≠n ti·ªán h∆°n trong vi·ªác ƒë·ªïi tr·∫£. Vui l√≤ng quay clip qu√° tr√¨nh ki·ªÉm tra h√†ng
                                        </li>

                                        <li>
                                            Khi ƒë·ªïi s·∫£n ph·∫©m , tr∆∞·ªùng h·ª£p kh√¥ng c√≤n size qu√Ω kh√°ch ƒë∆∞·ª£c ƒë·ªïi m·ªôt l·∫ßn duy nh·∫•t sang m·∫´u gi√†y kh√°c kh√¥ng th·∫•p h∆°n gi√° tr·ªã s·∫£n ph·∫©m ƒë√£ mua
                                        </li>
                                    </ol>
                                    

                                    
                                </p>
                                <h5 class="policy-title">
                                    Chi ph√≠ ship hai chi·ªÅu
                                </h5>

                                <p>
                                    C√°c l√Ω do nh∆∞ , shop g·ª≠i sai m√†u , sai m·∫´u , sai s·ªë l∆∞·ª£ng, sai k√≠ch th∆∞·ªõc ph√≠ ship ƒë·ªïi tr·∫£ ho√†n to√†n do shop chi tr·∫£.
                                </p>
                    </div>
                </div>
                <div class="tab-pane fade" id="pstorageInstructions" role="tabpanel" aria-labelledby="pstorageInstructions-tab">
                    <div class="description-productdetail">
                        <p>
                              üëüüëü ƒê·ªÉ gi√†y c·ªßa b·∫°n lu√¥n ƒë∆∞·ª£c gi·ªØ g√¨n v√† s·ª≠ d·ª•ng l√¢u d√†i, d∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë h∆∞·ªõng d·∫´n b·∫£o qu·∫£n gi√†y m√† b·∫°n c√≥ th·ªÉ tham kh·∫£o:
                        </p>
                       

                       <p>
                            ‚úîÔ∏è ƒê·ªçc k·ªπ nh√£n ch·ªâ d·∫´n: M·ªói ƒë√¥i gi√†y ƒë·ªÅu c√≥ nh·ªØng y√™u c·∫ßu ri√™ng v·ªÅ c√°ch b·∫£o qu·∫£n v√† v·ªá sinh. H√£y ƒë·ªçc k·ªπ nh√£n ch·ªâ d·∫´n ƒë·ªÉ bi·∫øt c√°ch chƒÉm s√≥c gi√†y c·ªßa b·∫°n ƒë√∫ng c√°ch.
                       </p>

                        
                        <p>
                            ‚úîÔ∏è L√†m s·∫°ch gi√†y th∆∞·ªùng xuy√™n: N·∫øu ƒë·ªÉ b·ª•i b·∫©n v√† m·ªì h√¥i t√≠ch t·ª• tr√™n gi√†y, ch√∫ng s·∫Ω g√¢y ·∫£nh h∆∞·ªüng ƒë·∫øn ch·∫•t l∆∞·ª£ng v√† ƒë·ªô b·ªÅn c·ªßa gi√†y. V√¨ v·∫≠y, h√£y l√†m s·∫°ch gi√†y c·ªßa b·∫°n th∆∞·ªùng xuy√™n b·∫±ng c√°ch lau ch√πi b·∫±ng khƒÉn ·∫©m ho·∫∑c b√†n ch·∫£i m·ªÅm.

                        </p>

                        <p>
                            ‚úîÔ∏è B·∫£o qu·∫£n gi√†y ·ªü n∆°i tho√°ng m√°t v√† kh√¥ r√°o: Kh√¥ng bao gi·ªù ƒë·ªÉ gi√†y ·ªü n∆°i ·∫©m ∆∞·ªõt ho·∫∑c ƒë·∫ßy n·∫Øng n√≥ng. H√£y b·∫£o qu·∫£n gi√†y c·ªßa b·∫°n ·ªü n∆°i tho√°ng m√°t v√† kh√¥ r√°o ƒë·ªÉ tr√°nh t√¨nh tr·∫°ng gi√†y b·ªã n·∫•m m·ªëc ho·∫∑c bong tr√≥c.
                        </p>

                        <p>
                            ‚úîÔ∏è S·ª≠ d·ª•ng ch·∫•t t·∫©y r·ª≠a ƒë√∫ng lo·∫°i: Khi s·ª≠ d·ª•ng ch·∫•t t·∫©y r·ª≠a ƒë·ªÉ v·ªá sinh gi√†y, h√£y ch·ªçn lo·∫°i ph√π h·ª£p v·ªõi ch·∫•t li·ªáu c·ªßa gi√†y. ƒê·ª´ng s·ª≠ d·ª•ng ch·∫•t t·∫©y r·ª≠a c√≥ ch·ª©a ho√° ch·∫•t m·∫°nh ho·∫∑c t·∫©y tr·∫Øng, v√¨ ch√∫ng c√≥ th·ªÉ l√†m h·ªèng ch·∫•t li·ªáu v√† l√†m gi·∫£m ƒë·ªô b·ªÅn c·ªßa gi√†y.
                        </p>

                        <p>
                             ‚úîÔ∏è B·∫£o qu·∫£n gi√†y trong h·ªôp ho·∫∑c t√∫i ƒë·ª±ng gi√†y: ƒê·ªÉ b·∫£o v·ªá gi√†y kh·ªèi b·ª•i b·∫©n v√† c√°c t√°c nh√¢n b√™n ngo√†i kh√°c, b·∫°n n√™n b·∫£o qu·∫£n gi√†y trong h·ªôp ho·∫∑c t√∫i ƒë·ª±ng gi√†y sau khi s·ª≠ d·ª•ng.
                        </p>

                        <p> 
                            
                            ‚úîÔ∏è Thay ƒë·ªïi ƒë√¥i gi√†y: Kh√¥ng n√™n s·ª≠ d·ª•ng c√πng m·ªôt ƒë√¥i gi√†y li√™n t·ª•c trong nhi·ªÅu ng√†y li√™n ti·∫øp. H√£y thay ƒë·ªïi ƒë√¥i gi√†y ƒë·ªÉ gi√∫p ch√∫ng ƒë∆∞·ª£c tho·∫£i m√°i v√† tr√°nh b·ªã h∆∞ h·ªèng.
                        </p>

                        <p>
                                   ‚ù§Ô∏è‚ù§Ô∏è Hy v·ªçng nh·ªØng h∆∞·ªõng d·∫´n b·∫£o qu·∫£n gi√†y tr√™n s·∫Ω gi√∫p b·∫°n gi·ªØ cho gi√†y c·ªßa m√¨nh lu√¥n m·ªõi v√† b·ªÅn b·ªâ.
                        </p>
                        
                        

                        

                       


                    
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>


{{!-- Modal --}}

<!-- Modal Fullscreen xl -->
<div class="modal ProductImgZoomModal" id="ProductImgZoomModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
     
      <div class="modal-body">
            <div id="ProductImgZoom" class="carousel slide" data-ride="carousel">
                <button type="button" class="close closeBtn" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true"><i class="closeBtn__icon fa-regular fa-circle-xmark"></i></span>
                </button>  

                  <ol class="carousel-indicators">
                    {{#each productInfor.productImg}} 

                    <li data-target="#ProductImgZoom" data-slide-to="{{@index}}" class=""></li>
            
                    {{/each}}

                </ol>
                <div class="carousel-inner">   

                    {{#each productInfor.productImg}} 
                    
                         <div class="carousel-item">
                            <img class="d-block" src="{{this}}" alt="First slide">
                        </div>
                    {{/each}}
              
                </div>
                <a class="carousel-control-prev" href="#ProductImgZoom" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#ProductImgZoom" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
         </div>
      </div>
    </div>
  </div>
</div>

{{>modalUserInfor}}

<script>


    const selectSizeBtns = document.querySelectorAll('.selectSize__btn--item');
   
    //Select size
    selectSizeBtns.forEach((item)=> {
        item.addEventListener('click',(e)=> {
            document.querySelector('.selectSize__btn--item.active').classList.remove('active');
            e.target.classList.add('active');
        })
    })

    // Change IMG main

    const productImgList = document.querySelectorAll('.detailProduct__img--item');
   
    // Active img main
    productImgList.forEach((item)=> {
        item.addEventListener('mouseover',(e)=> {
            e.stopPropagation();
            const imgActiveElement = document.querySelector('.detailProduct__img--item.active');

            imgActiveElement && imgActiveElement.classList.remove('active');

            e.target.classList.add('active');
            document.querySelector('.detailProduct__img--main img').src=e.target.src;

        })
    })

    //changeProductQuantity
     
       
        function plusQuantity() {
            const currentQuantity = document.getElementById('quantity').value;

            document.getElementById('quantity').value = Number(currentQuantity) + 1;
            
        }
        function minusQuantity() {

        
            const currentQuantity = Number(document.getElementById('quantity').value);
            
            if(currentQuantity > 1) {
                document.getElementById('quantity').value =currentQuantity - 1;

            }
            
        }


   

   
    // show modal cart
    $('#cartModal').on('show.bs.modal',async function (event) {
        var button = $(event.relatedTarget) 

       

        const cartItemId = document.querySelector('#productId').value;

        const productInfor =await fetch(`/products/infor/${cartItemId}`).then((res)=> {
            return res.json();
        }).then(productInfor=> {
            return productInfor
        })

        const cartItemImgUrl = `{{productAvatar}}`

        const cartItemName = document.querySelector('.detailProduct__content--name').innerText;

        const cartItemSize = Number(document.querySelector('.selectSize__btn--item.active').textContent);

        const cartItemColor = document.querySelector('.productColor__text').textContent;

        const cartItemAmount = Number(document.getElementById('quantity').value);

        const cartItemPrice = Number(document.querySelector('.detailProduct__price').dataset.price);

      

        const cartItemPriceString =  numberToMoney(cartItemPrice);



        const cartItemInfor = {
            cartItemId,
            cartItemImgUrl,
            cartItemName,
            cartItemSize,
            cartItemColor,
            cartItemAmount,
            cartItemPrice,
            cartItemSlug: productInfor.slug,
            cartItemPriceString,
        }

        // Add item to cart list in localstorage


           const localListCart = JSON.parse(localStorage.getItem('cartProductList'));

           if(localListCart !== null) {
                const haveStoraged = localListCart.some((item)=> item.cartItemId === cartItemInfor.cartItemId && item.cartItemSize === cartItemInfor.cartItemSize);


                if(haveStoraged) {
                        localListCart.map(item=> {
                            if(item.cartItemId === cartItemInfor.cartItemId) {
                                item.cartItemAmount = item.cartItemAmount + cartItemAmount
                            }
                            return item
                        })
                }
                else {
                    localListCart.push(cartItemInfor)
                }

                // save to store
                localStorage.setItem('cartProductList',JSON.stringify(localListCart))

                // render UI
                renderListCart(localListCart)
           }
                
           else {
              localStorage.setItem('cartProductList',JSON.stringify([cartItemInfor]))
              renderListCart([cartItemInfor])
           }

        

        var modal = $(this)
        // modal.find('.modal-title').text('New message to ' + recipient)

      //  modal.find('.modal-body input').val(productInfor)

        })

    // Auto update cart item when have change

   

        $('#ProductImgZoomModal').on('show.bs.modal', function (e) {

            const activeImgIndex = Number(document.querySelector('.detailProduct__img--item.active').dataset.index);


            const carouselInnerElement = document.querySelectorAll('#ProductImgZoom .carousel-inner .carousel-item');
            
            const carouselDotsElemement = document.querySelectorAll('#ProductImgZoom .carousel-indicators li');

            function addActiveClassFunction (elements) {
             elements.forEach((item,index)=> {
                if(index === activeImgIndex) {
                    item.classList.add('active');
                }
                else {
                    item.classList.remove('active');
                }
            })
            }
            addActiveClassFunction(carouselInnerElement);
            addActiveClassFunction(carouselDotsElemement);

         

        })

        $('#ProductImgZoom').carousel({
            interval: false,
        });

</script>
<script src='/js/renderCart.js'></script>
<script src='/js/payment.js'></script>
